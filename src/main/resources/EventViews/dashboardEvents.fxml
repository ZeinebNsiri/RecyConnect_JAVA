<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.BarChart?>
<?import javafx.scene.chart.CategoryAxis?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>
<?import javafx.scene.chart.PieChart?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>
<?import javafx.scene.text.Text?>

<?import javafx.scene.layout.Region?>
<BorderPane stylesheets="@DashboardEvents.css" prefHeight="800.0" prefWidth="1100.0" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="controllers.Events.DashboardEventsController">
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20.0" style="-fx-background-color: #E8F5E9 ;" BorderPane.alignment="CENTER">
            <children>
                <Label text="ðŸ“Š Tableau de Bord Analytics" textFill="BLACK">
                    <font>
                        <Font name="System Bold" size="26.0" />
                    </font>
                </Label>
                <Region HBox.hgrow="ALWAYS" />
                <Button onAction="#refreshDashboard" style="-fx-background-color: white; -fx-text-fill: #93b181; -fx-font-weight: bold; -fx-background-radius: 20;" text="ðŸ”„ Actualiser">
                    <font>
                        <Font name="System Bold" size="14.0" />
                    </font>
                </Button>
            </children>
            <padding>
                <Insets top="20.0" bottom="20.0" left="25.0" right="25.0" />
            </padding>
        </HBox>
    </top>

    <center  >

        <TabPane style="-fx-background-color: #E8F5E9 ;" fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE" BorderPane.alignment="CENTER">
            <tabs>
                <!-- Tab 1: Events -->
                <Tab text="Ã‰vÃ©nements">
                    <content>
                        <ScrollPane fitToHeight="true" fitToWidth="true">
                            <content>
                                <VBox spacing="40.0" style="-fx-background-color: #ffffff;">
                                    <padding>
                                        <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                                    </padding>
                                    <children>
                                        <GridPane fx:id="statsGrid" hgap="20.0" vgap="10.0">
                                            <columnConstraints>
                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                                                <ColumnConstraints hgrow="SOMETIMES" minWidth="10.0" prefWidth="100.0" />
                                            </columnConstraints>
                                            <rowConstraints>
                                                <RowConstraints minHeight="10.0" prefHeight="30.0" vgrow="SOMETIMES" />
                                                <RowConstraints minHeight="10.0" prefHeight="50.0" vgrow="SOMETIMES" />
                                            </rowConstraints>
                                            <children>
                                                <VBox alignment="CENTER" style="-fx-background-color: #0d4e0d; -fx-background-radius: 5;">
                                                    <children>
                                                        <Label text="Total Ã‰vÃ©nements" textFill="WHITE">
                                                            <font>
                                                                <Font name="System Bold" size="14.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #25327c; -fx-background-radius: 5;" GridPane.columnIndex="1">
                                                    <children>
                                                        <Label text="CapacitÃ© Totale" textFill="WHITE">
                                                            <font>
                                                                <Font name="System Bold" size="14.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #93b181; -fx-background-radius: 5;" GridPane.columnIndex="2">
                                                    <children>
                                                        <Label text="RÃ©servations Totales" textFill="WHITE">
                                                            <font>
                                                                <Font name="System Bold" size="14.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #5f79af; -fx-background-radius: 5;" GridPane.columnIndex="3">
                                                    <children>
                                                        <Label text="Utilisation Moyenne" textFill="WHITE">
                                                            <font>
                                                                <Font name="System Bold" size="14.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #ecf0f1; -fx-background-radius: 5;" GridPane.rowIndex="1">
                                                    <children>
                                                        <Label fx:id="totalEventsLabel" text="0" textFill="#0d4e0d">
                                                            <font>
                                                                <Font name="System Bold" size="24.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #ecf0f1; -fx-background-radius: 5;" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                    <children>
                                                        <Label fx:id="totalCapacityLabel" text="0" textFill="#25327c">
                                                            <font>
                                                                <Font name="System Bold" size="24.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #ecf0f1; -fx-background-radius: 5;" GridPane.columnIndex="2" GridPane.rowIndex="1">
                                                    <children>
                                                        <Label fx:id="totalReservationsLabel" text="0" textFill="#93b181">
                                                            <font>
                                                                <Font name="System Bold" size="24.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                                <VBox alignment="CENTER" style="-fx-background-color: #ecf0f1; -fx-background-radius: 5;" GridPane.columnIndex="3" GridPane.rowIndex="1">
                                                    <children>
                                                        <Label fx:id="avgUtilizationLabel" text="0%" textFill="#5f79af">
                                                            <font>
                                                                <Font name="System Bold" size="24.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                    <padding>
                                                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                                                    </padding>
                                                </VBox>
                                            </children>
                                        </GridPane>

                                        <HBox spacing="20.0">
                                            <children>
                                                <VBox spacing="10.0" HBox.hgrow="ALWAYS">
                                                    <children>
                                                        <Label text="Utilisation de la CapacitÃ© des Ã‰vÃ©nements" styleClass="section-header">
                                                            <font>
                                                                <Font name="System Bold" size="14.0" />
                                                            </font>
                                                        </Label>
                                                        <PieChart fx:id="pieChartCapacity" title="CapacitÃ© des Ã‰vÃ©nements" legendVisible="true" labelsVisible="true" prefHeight="300.0" />
                                                    </children>
                                                </VBox>
                                                <VBox spacing="10.0" HBox.hgrow="ALWAYS">
                                                    <children>
                                                        <Label text="Ã‰vÃ©nements les Plus Populaires" styleClass="section-header">
                                                            <font>
                                                                <Font name="System Bold" size="14.0" />
                                                            </font>
                                                        </Label>
                                                        <BarChart fx:id="barChartPopular" title="Ã‰vÃ©nements Populaires" prefHeight="300.0">
                                                            <xAxis>
                                                                <CategoryAxis label="Ã‰vÃ©nements" />
                                                            </xAxis>
                                                            <yAxis>
                                                                <NumberAxis label="RÃ©servations" />
                                                            </yAxis>
                                                        </BarChart>
                                                    </children>
                                                </VBox>
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                            </content>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- Tab 2: Workshops -->
                <Tab text="Workshops">
                    <content>
                        <ScrollPane fitToHeight="true" fitToWidth="true" style="-fx-background-color:transparent;">
                            <content>
                                <VBox spacing="30" style="-fx-background-color: #ffffff;">
                                    <padding>
                                        <Insets top="30" right="30" bottom="30" left="30"/>
                                    </padding>
                                    <Label text="Statistiques des Workshops" style="-fx-font-size: 24px; -fx-text-fill: #014421; -fx-font-weight: bold;"/>

                                    <!-- 1) BarChart - Nombre du workshop par catÃ©gorie -->
                                    <VBox spacing="10">
                                        <Label text="Nombre du workshop par catÃ©gorie" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                        <BarChart fx:id="barChartCategory" prefHeight="300" title="Workshops par CatÃ©gorie">
                                            <xAxis>
                                                <CategoryAxis label="CatÃ©gorie"/>
                                            </xAxis>
                                            <yAxis>
                                                <NumberAxis label="Nombre"/>
                                            </yAxis>
                                        </BarChart>
                                    </VBox>

                                    <!-- 2) PieChart - Total des notes par catÃ©gorie -->
                                    <VBox spacing="10">
                                        <Label text="RÃ©partition du total des notes par catÃ©gorie" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                        <PieChart fx:id="pieChartRatingSum" prefHeight="700"/>
                                    </VBox>

                                    <!-- 3) PolarArea (converted to LineChart) - Moyenne des notes par Workshop -->
                                    <VBox spacing="10">
                                        <Label text="Moyenne de notes par Workshop" style="-fx-font-size: 16px; -fx-font-weight: bold;"/>
                                        <LineChart fx:id="polarChartAverage" title="Moyenne par Workshop" prefHeight="300">
                                            <xAxis>
                                                <CategoryAxis label="Workshop"/>
                                            </xAxis>
                                            <yAxis>
                                                <NumberAxis label="Moyenne"/>
                                            </yAxis>
                                        </LineChart>
                                    </VBox>
                                </VBox>
                            </content>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- Tab 3: Articles -->
                <Tab text="Articles">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background-color: #ffffff;">
                            <content>
                                <VBox spacing="30" alignment="TOP_CENTER" style="-fx-background-color: #ffffff;">
                                    <padding>
                                        <Insets top="20" right="20" bottom="20" left="20"/>
                                    </padding>

                                    <!-- PieChart -->
                                    <Label text="RÃ©partition des Articles par CatÃ©gorie" style="-fx-font-size: 24px; -fx-text-fill: #222; -fx-font-weight: bold;"/>
                                    <PieChart fx:id="pieChartArticle" prefWidth="1000" maxWidth="Infinity"/>

                                    <!-- BarChart: QuantitÃ© des articles par catÃ©gorie -->
                                    <VBox spacing="10" alignment="TOP_CENTER">
                                        <Label text="QuantitÃ© des Articles par CatÃ©gorie" style="-fx-font-size: 24px; -fx-text-fill: #222; -fx-font-weight: bold;"/>
                                        <BarChart fx:id="barChartCategorie" prefWidth="700" prefHeight="500">
                                            <xAxis>
                                                <CategoryAxis label="CatÃ©gories"/>
                                            </xAxis>
                                            <yAxis>
                                                <NumberAxis label="QuantitÃ©"/>
                                            </yAxis>
                                        </BarChart>
                                    </VBox>

                                    <!-- BarChart: QuantitÃ© de chaque article -->
                                    <VBox spacing="10" alignment="TOP_CENTER">
                                        <Label text="QuantitÃ© de chaque Article" style="-fx-font-size: 24px; -fx-text-fill: #222; -fx-font-weight: bold;"/>
                                        <BarChart fx:id="barChartArticle" prefWidth="700" prefHeight="500">
                                            <xAxis>
                                                <CategoryAxis label="Articles"/>
                                            </xAxis>
                                            <yAxis>
                                                <NumberAxis label="QuantitÃ©"/>
                                            </yAxis>
                                        </BarChart>
                                    </VBox>
                                </VBox>
                            </content>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- Tab 4: Utilisateurs -->
                <Tab text="Utilisateurs">
                    <content>
                        <ScrollPane fitToWidth="true" style="-fx-background-color: #ffffff;">
                            <content>
                                <VBox spacing="20" alignment="CENTER" style="-fx-background-color: #ffffff;">
                                    <padding>
                                        <Insets top="20" left="20" right="20" bottom="20"/>
                                    </padding>

                                    <StackPane>
                                        <VBox style="-fx-background-color: white; -fx-padding: 20px; -fx-background-radius: 10; -fx-border-radius: 10; -fx-effect: dropshadow(gaussian, gray, 10, 0.5, 0, 0);"
                                              maxWidth="600">
                                            <Text text="RÃ©partition des utilisateurs par rÃ´le" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                                            <PieChart fx:id="rolePieChart" prefWidth="600" prefHeight="300"/>
                                            <HBox spacing="10" alignment="CENTER">
                                                <Label text="Total Utilisateurs: " style="-fx-font-weight: bold;"/>
                                                <Label fx:id="totalRoleCount" style="-fx-font-size: 16px;"/>
                                            </HBox>
                                            <HBox spacing="10" alignment="CENTER">
                                                <Label text="Particuliers: " style="-fx-font-weight: bold;"/>
                                                <Label fx:id="particulierCount" style="-fx-font-size: 16px;"/>
                                            </HBox>
                                            <HBox spacing="10" alignment="CENTER">
                                                <Label text="Professionnels: " style="-fx-font-weight: bold;"/>
                                                <Label fx:id="professionnelCount" style="-fx-font-size: 16px;"/>
                                            </HBox>
                                        </VBox>
                                    </StackPane>

                                    <StackPane>
                                        <VBox style="-fx-background-color: white; -fx-padding: 20px; -fx-background-radius: 10; -fx-border-radius: 10; -fx-effect: dropshadow(gaussian, gray, 10, 0.5, 0, 0);"
                                              maxWidth="600">
                                            <Text text="RÃ©partition des utilisateurs selon le statut" style="-fx-font-size: 18px; -fx-font-weight: bold;"/>
                                            <PieChart fx:id="statusPieChart" prefWidth="600" prefHeight="300"/>
                                            <HBox spacing="10" alignment="CENTER">
                                                <Label text="Total Utilisateurs: " style="-fx-font-weight: bold;"/>
                                                <Label fx:id="totalStatusCount" style="-fx-font-size: 16px;"/>
                                            </HBox>
                                            <HBox spacing="10" alignment="CENTER">
                                                <Label text="Actifs: " style="-fx-font-weight: bold;"/>
                                                <Label fx:id="actifCount" style="-fx-font-size: 16px;"/>
                                            </HBox>
                                            <HBox spacing="10" alignment="CENTER">
                                                <Label text="DÃ©sactivÃ©s: " style="-fx-font-weight: bold;"/>
                                                <Label fx:id="desactiveCount" style="-fx-font-size: 16px;"/>
                                            </HBox>
                                        </VBox>
                                    </StackPane>
                                </VBox>
                            </content>
                        </ScrollPane>
                    </content>
                </Tab>

                <!-- Tab 5: Commandes -->
                <Tab text="Commandes">
                    <content>
                        <AnchorPane prefWidth="800" prefHeight="500" style="-fx-background-color: #ffffff;">
                            <VBox style="-fx-background-color: #ffffff;" spacing="20" AnchorPane.leftAnchor="20" AnchorPane.rightAnchor="20" AnchorPane.topAnchor="30">
                                <!-- Carte Statistiques -->
                                <VBox spacing="10"
                                      style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20;">
                                    <Label text="Statistiques Ventes" style="-fx-font-weight: bold; -fx-text-fill: #003366;" />
                                    <HBox spacing="50">
                                        <VBox>
                                            <Label text="Total des ventes - Aujourd'hui" />
                                            <Label fx:id="totalVentesLabel" text="0 TND" style="-fx-font-weight: bold;" />
                                        </VBox>
                                        <VBox>
                                            <Label text="Ventes PayÃ©es (Commandes payÃ©es)" />
                                            <Label fx:id="ventesPayeesLabel" text="0" style="-fx-font-weight: bold;" />
                                        </VBox>
                                    </HBox>
                                </VBox>

                                <!-- Graphiques cÃ´te Ã  cÃ´te -->
                                <HBox spacing="20">
                                    <!-- Pie Chart Ã  gauche -->
                                    <PieChart fx:id="pieChartVentes" prefHeight="250" prefWidth="350" />
                                    <!-- Bar Chart Ã  droite -->
                                    <BarChart fx:id="barChartVisa" prefHeight="250" prefWidth="350">
                                        <xAxis>
                                            <CategoryAxis fx:id="xAxis" label="MÃ©thodes de Paiement" />
                                        </xAxis>
                                        <yAxis>
                                            <NumberAxis fx:id="yAxis" label="Nombre de commandes" />
                                        </yAxis>
                                    </BarChart>
                                </HBox>
                            </VBox>
                        </AnchorPane>
                    </content>
                </Tab>
            </tabs>
        </TabPane>

    </center>
    <bottom>
        <HBox alignment="CENTER" spacing="10.0" style="-fx-background-color: #ecf0f1; -fx-padding: 10px;">
            <Label text="Â© 2025 - Tableau de bord unifiÃ©" />
        </HBox>
    </bottom>
</BorderPane>